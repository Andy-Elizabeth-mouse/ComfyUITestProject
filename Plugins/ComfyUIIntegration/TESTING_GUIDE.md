# ComfyUI Integration Plugin - 测试验证脚本

## 🧪 自动化测试清单

用户可以按照以下步骤逐一验证插件功能是否正常工作。

### 阶段1: 基础安装验证

#### ✅ 1.1 插件加载测试
- [ ] 启动 UE5 编辑器
- [ ] 检查 Edit > Plugins 中是否显示 "ComfyUI Integration"
- [ ] 插件状态为 "Enabled"
- [ ] 无错误提示

**期望结果**: 插件正常显示且已启用

#### ✅ 1.2 菜单访问测试  
- [ ] 查看顶部菜单栏 "Tools"
- [ ] 是否存在 "ComfyUI Integration" 选项
- [ ] 点击后能打开插件窗口

**期望结果**: 菜单项存在且可点击

#### ✅ 1.3 UI 界面测试
- [ ] 插件窗口正常显示
- [ ] 包含以下基本元素：
  - [ ] 工作流类型选择器
  - [ ] 提示词输入框
  - [ ] 服务器地址配置
  - [ ] 生成按钮

**期望结果**: UI 界面完整显示

### 阶段2: ComfyUI 连接验证

#### ✅ 2.1 ComfyUI 服务状态
在开始测试前，确保 ComfyUI 正在运行：

```bash
# Windows 命令行测试
curl -X GET http://127.0.0.1:8188/system_stats

# PowerShell 测试  
Invoke-RestMethod -Uri "http://127.0.0.1:8188/system_stats" -Method Get
```

**期望结果**: 返回 ComfyUI 系统状态信息

#### ✅ 2.2 插件连接测试
- [ ] 在插件中设置服务器地址: `http://127.0.0.1:8188`
- [ ] 点击连接测试按钮（如果有）
- [ ] 观察连接状态提示

**期望结果**: 显示连接成功

### 阶段3: 基础功能验证

#### ✅ 3.1 文生图功能测试

**测试步骤**:
1. [ ] 选择工作流类型: "Text to Image"
2. [ ] 输入测试提示词:
   ```
   正向: "a simple red apple on white background, photorealistic"
   负向: "blurry, low quality"
   ```
3. [ ] 点击 "Generate" 按钮
4. [ ] 等待生成完成（可能需要1-3分钟）
5. [ ] 检查是否有图像预览显示

**期望结果**: 成功生成苹果图像

#### ✅ 3.2 图像输入功能测试（新功能重点）

**准备工作**:
1. [ ] 在内容浏览器中导入一张测试纹理
2. [ ] 选择工作流类型: "Image to Image"

**测试文件加载方式**:
1. [ ] 点击 "Load Image" 按钮
2. [ ] 选择一张本地图片文件
3. [ ] 确认图像在预览区域显示

**期望结果**: 图像正确加载和显示

**测试拖拽方式** ⭐:
1. [ ] 从内容浏览器选择一个纹理资产
2. [ ] 拖拽到插件的图像输入区域
3. [ ] 观察拖拽过程中的视觉反馈:
   - [ ] 拖拽悬停时边框高亮
   - [ ] 显示 "释放以设置图像" 提示
4. [ ] 释放鼠标，确认图像设置成功
5. [ ] 检查清除按钮是否变为可用状态

**期望结果**: 拖拽功能正常，图像正确设置

### 阶段4: 高级功能验证

#### ✅ 4.1 图生图完整流程
1. [ ] 使用拖拽方式设置输入图像
2. [ ] 输入修改提示词:
   ```
   正向: "same object but in cartoon style, colorful"
   负向: "realistic, photographic"
   ```
3. [ ] 点击生成
4. [ ] 检查生成结果

**期望结果**: 生成风格化的图像

#### ✅ 4.2 资产保存功能
1. [ ] 生成图像后，点击 "Save" 按钮
2. [ ] 检查内容浏览器中是否出现新的纹理资产
3. [ ] 路径应为: `/Game/ComfyUI/Generated/`
4. [ ] 双击资产确认可以正常打开

**期望结果**: 资产正确保存到项目中

#### ✅ 4.3 多种工作流测试
测试其他工作流类型（如果可用）:
- [ ] Text to 3D
- [ ] Image to 3D  
- [ ] Texture Generation
- [ ] Custom Workflow

**期望结果**: UI 根据不同工作流类型显示相应选项

### 阶段5: 错误处理验证

#### ✅ 5.1 网络错误处理
1. [ ] 停止 ComfyUI 服务
2. [ ] 在插件中尝试生成图像
3. [ ] 检查错误提示是否友好

**期望结果**: 显示清晰的连接错误提示

#### ✅ 5.2 文件格式处理
1. [ ] 尝试拖拽非纹理资产（如音频文件）
2. [ ] 检查是否有适当的错误提示或过滤

**期望结果**: 正确拒绝不支持的文件格式

#### ✅ 5.3 异常恢复
1. [ ] 在生成过程中关闭插件窗口
2. [ ] 重新打开插件
3. [ ] 检查界面状态是否正常

**期望结果**: 插件能正常恢复状态

## 📊 测试结果报告模板

```markdown
# ComfyUI Integration Plugin v0.8.0-beta 测试报告

**测试环境**:
- UE版本: 5.x.x
- ComfyUI版本: x.x.x  
- 操作系统: Windows xx
- 硬件: [显卡型号, 内存大小]

**测试日期**: YYYY-MM-DD
**测试人员**: [姓名]

## 测试结果总览
- 通过测试: X/Y
- 失败测试: X/Y  
- 严重问题: X
- 一般问题: X

## 详细测试结果

### 阶段1: 基础安装验证
- [x] 1.1 插件加载测试 - ✅通过
- [x] 1.2 菜单访问测试 - ✅通过  
- [x] 1.3 UI界面测试 - ✅通过

### 阶段2: ComfyUI连接验证
- [x] 2.1 ComfyUI服务状态 - ✅通过
- [x] 2.2 插件连接测试 - ❌失败 [具体问题描述]

### 阶段3: 基础功能验证  
- [x] 3.1 文生图功能测试 - ✅通过
- [x] 3.2 图像输入功能测试 - ⚠️部分通过 [问题说明]

### 发现的问题
1. **严重**: [问题描述] - [影响程度] - [复现步骤]
2. **一般**: [问题描述] - [建议改进]

### 用户体验反馈
- 拖拽功能非常直观，大大提升了效率 👍
- UI响应速度良好
- 错误提示清晰易懂

### 改进建议
1. [具体建议]
2. [具体建议]

### 整体评价
[对插件的整体印象和评价]
```

## 🎯 重点测试项目

**特别关注以下新功能**:
1. **拖拽功能的稳定性和用户体验**
2. **不同纹理格式的兼容性**  
3. **大文件处理性能**
4. **错误情况的处理**

## 📋 测试完成清单

完成所有测试后，请确认：
- [ ] 所有基础功能正常工作
- [ ] 新的拖拽功能符合预期
- [ ] 没有严重的崩溃或错误
- [ ] UI响应流畅
- [ ] 资产保存功能正常

**如果所有测试通过，恭喜！插件已准备好供日常使用。**
**如果发现问题，请使用上面的报告模板向我们反馈。**

---

*测试指南版本: v1.0 | 对应插件版本: v0.8.0-beta*
